<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="AICalories.Views.MainPage">
    <!--<ContentPage.ToolbarItems>
        <ToolbarItem Text="Menu" IconImageSource="menu.png" Clicked="OnMenuButtonClicked" />
    </ContentPage.ToolbarItems>-->
    
    <ScrollView>
        <Grid RowDefinitions=".25*,.65*,.1*"
              Padding="20,10" RowSpacing="10">
            


            <!--Stats Data-->
            
            <Frame Grid.Row="0" Padding="10" Style="{StaticResource MainFrameStyle}">
                <AbsoluteLayout>
                    <Grid RowDefinitions=".2*,.8*" Padding="10"
                            AbsoluteLayout.LayoutBounds="0,0,1,1"
                            AbsoluteLayout.LayoutFlags="All">
                        <Label Text="Today:" Style="{StaticResource LabelAppStyle}"
                                Margin="0"/>
                        <Grid Grid.Row="1"
                              ColumnDefinitions="*,*,*,*">
                                <!--Calories-->
                                <Frame Grid.Column="0"
                                       Style="{StaticResource TodayStatsFrameStyle}" 
                                       BackgroundColor="#e8736b"
                                       BorderColor="#e8736b">
                                    <VerticalStackLayout
                                       VerticalOptions="CenterAndExpand" 
                                       HorizontalOptions="CenterAndExpand">
                                        
                                        <Label
                                            Text="Calories" Style="{StaticResource LabelAppStyle}"
                                            FontSize="Medium" LineBreakMode="NoWrap" />
                                
                                        <Label
                                            Text="{Binding TotalCalories}" Style="{StaticResource LabelAppStyle}"
                                            />

                                    </VerticalStackLayout>
                                </Frame>
                                
                                <!--Proteins-->
                                <Frame Grid.Column="1"
                                       Style="{StaticResource TodayStatsFrameStyle}" 
                                       BackgroundColor="#6b97e8"
                                       BorderColor="#6b97e8">
                                    <VerticalStackLayout
                                       VerticalOptions="CenterAndExpand" 
                                       HorizontalOptions="CenterAndExpand">
                                        
                                        <Label
                                            Text="Proteins" Style="{StaticResource LabelAppStyle}"
                                            FontSize="Medium" LineBreakMode="NoWrap" />
                                
                                        <Label
                                            Text="{Binding TotalProteins}" Style="{StaticResource LabelAppStyle}"
                                            />

                                    </VerticalStackLayout>
                                </Frame>
                                
                                <!--Fats-->
                                <Frame Grid.Column="2"
                                       Style="{StaticResource TodayStatsFrameStyle}" 
                                       BackgroundColor="#e8cb6b"
                                       BorderColor="#e8cb6b">
                                    <VerticalStackLayout
                                       VerticalOptions="CenterAndExpand" 
                                       HorizontalOptions="CenterAndExpand">
                                        
                                        <Label
                                            Text="Fats" Style="{StaticResource LabelAppStyle}"
                                            FontSize="Medium" LineBreakMode="NoWrap" />
                                
                                        <Label
                                            Text="{Binding TotalFats}" Style="{StaticResource LabelAppStyle}"
                                            />

                                    </VerticalStackLayout>
                                </Frame>
                                
                                <!--Carbohydrates-->
                                <Frame Grid.Column="3"
                                       Style="{StaticResource TodayStatsFrameStyle}" 
                                       BackgroundColor="#6be893"
                                       BorderColor="#6be893">
                                    <VerticalStackLayout
                                       VerticalOptions="CenterAndExpand" 
                                       HorizontalOptions="CenterAndExpand">
                                        
                                        <Label
                                            Text="Carbs" Style="{StaticResource LabelAppStyle}"
                                            FontSize="Medium" LineBreakMode="NoWrap" />
                                
                                        <Label
                                            Text="{Binding TotalCarbohydrates}" Style="{StaticResource LabelAppStyle}"
                                            />

                                    </VerticalStackLayout>
                                </Frame>

                        </Grid>
                            
                    </Grid>

                </AbsoluteLayout>
            </Frame>


            <!--Last Meal Data-->

            <Frame Grid.Row="1" Padding="0" Style="{StaticResource MainFrameStyle}">
                <AbsoluteLayout >
                    <ScrollView
                            AbsoluteLayout.LayoutBounds="0,0,1,1"
                            AbsoluteLayout.LayoutFlags="All" >
                    <Grid x:Name="historyGrid"  RowDefinitions="Auto,*" Padding="20"
                            IsVisible="{Binding IsHistoryGridVisible}"
                            AbsoluteLayout.LayoutBounds="0,0,1,1"
                            AbsoluteLayout.LayoutFlags="All" >
                        <Frame Padding="0" Style="{StaticResource MainFrameStyle}"
                                MaximumHeightRequest="200">
                        
                            <Image x:Name="lastHistoryItemImage" Source="{Binding LastHistoryItemImage}" Aspect="AspectFill"/>

                        </Frame>
                        <Grid Grid.Row="1" RowDefinitions="Auto,*">
                            <Grid  Grid.Row="0"
                                    RowDefinitions="*,*,*,*" ColumnDefinitions="*,*">
                                
                                <Label Grid.Row="0" Text="{Binding LastHistoryItemName}" Style="{StaticResource LabelAppStyle}"/>
                                <Label Grid.Row="1" Text="{Binding LastHistoryItemCalories}" Style="{StaticResource LabelAppStyle}"/>

                            </Grid>

                            <!--Ingredients-->

                            <CollectionView Grid.Row="1" x:Name="ingredientsCollectionView"
                                            ItemsSource="{Binding Ingredients}"
                                            ItemsLayout="GridItemsLayout"
                                            Margin="10">

                                <CollectionView.ItemTemplate>
                                    <DataTemplate>
                                        <Grid Padding="10">
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="Auto" />
                                                <RowDefinition Height="Auto" />
                                                <RowDefinition Height="Auto" />
                                                <RowDefinition Height="Auto" />
                                                <RowDefinition Height="Auto" />
                                                <RowDefinition Height="Auto" />
                                            </Grid.RowDefinitions>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto" />
                                                <ColumnDefinition Width="*" />
                                            </Grid.ColumnDefinitions>

                                            <Label Text="Name:" Grid.Row="0" Grid.Column="0" FontAttributes="Bold" Style="{StaticResource LabelAppStyle}" />
                                            <Label Text="{Binding Name}" Grid.Row="0" Grid.Column="1" Style="{StaticResource LabelAppStyle}" />

                                            <Label Text="Weight:" Grid.Row="1" Grid.Column="0" FontAttributes="Bold" Style="{StaticResource LabelAppStyle}" />
                                            <Label Text="{Binding Weight}" Grid.Row="1" Grid.Column="1" Style="{StaticResource LabelAppStyle}" />

                                            <Label Text="Calories:" Grid.Row="2" Grid.Column="0" FontAttributes="Bold" Style="{StaticResource LabelAppStyle}" />
                                            <Label Text="{Binding Calories}" Grid.Row="2" Grid.Column="1" Style="{StaticResource LabelAppStyle}" />

                                            <Label Text="Proteins:" Grid.Row="3" Grid.Column="0" FontAttributes="Bold" Style="{StaticResource LabelAppStyle}" />
                                            <Label Text="{Binding Proteins}" Grid.Row="3" Grid.Column="1" Style="{StaticResource LabelAppStyle}" />

                                            <Label Text="Fats:" Grid.Row="4" Grid.Column="0" FontAttributes="Bold" Style="{StaticResource LabelAppStyle}" />
                                            <Label Text="{Binding Fats}" Grid.Row="4" Grid.Column="1" Style="{StaticResource LabelAppStyle}" />

                                            <Label Text="Carbohydrates:" Grid.Row="5" Grid.Column="0" FontAttributes="Bold" Style="{StaticResource LabelAppStyle}" />
                                            <Label Text="{Binding Carbohydrates}" Grid.Row="5" Grid.Column="1" Style="{StaticResource LabelAppStyle}" />
                                        </Grid>
                                    </DataTemplate>
                                </CollectionView.ItemTemplate>
                            </CollectionView>

                        </Grid>
                    </Grid>
                    </ScrollView>
                    <!--Loading-->
                    <Label x:Name="MakeFirstRecordLabel"
                        AbsoluteLayout.LayoutBounds="0.5,0.5,-1,-1"
                        AbsoluteLayout.LayoutFlags="PositionProportional"
                        MaximumWidthRequest="200"
                        FontSize="Title" FontAttributes="Bold"
                        Text="Make your first record" Style="{StaticResource LabelAppStyle}"
                        IsVisible="{Binding IsLabelVisible}"/>

                    <ActivityIndicator
                        AbsoluteLayout.LayoutBounds="0.5,0.5,-1,-1"
                        AbsoluteLayout.LayoutFlags="PositionProportional"
                        IsVisible="{Binding IsLoading}"
                        IsRunning="{Binding IsLoading}"
                        Style="{StaticResource MainActivityIndicatorStyle}"
        
                        />
                </AbsoluteLayout>
            </Frame>


        <!--Add New-->

        <Button
                Text="New &#xFF0B;"
                Padding="0"
                Grid.Row="2"
                Grid.Column="0"
                Style="{StaticResource ImageOptionStyle}"
                Command="{Binding NewImageCommand}">
            

        </Button>
                            <!--<Setter Property="TextColor" Value="{AppThemeBinding Light={StaticResource Black}, Dark={StaticResource White}}" />-->

        <!--<Button Text="Select"
                Padding="0"
                Grid.Row="2"
                Grid.Column="0" Grid.ColumnSpan="1"
                Style="{StaticResource ImageOptionStyle}"
                Clicked="OnSelectImageClicked"/>-->


        
        <Grid.GestureRecognizers>
            <SwipeGestureRecognizer Direction="Left" Swiped="OnSwipedLeft"/>
            <SwipeGestureRecognizer Direction="Right" Swiped="OnSwipedRight"/>
        </Grid.GestureRecognizers>
    </Grid>
    </ScrollView>

    <!--<VerticalStackLayout
        VerticalOptions="Center" 
        HorizontalOptions="Center"
        WidthRequest="200"
        Spacing="10">
        
        <Frame
            CornerRadius='20'
            BorderColor='Black'
            WidthRequest='200'
            HeightRequest='100'>

            <Frame.GestureRecognizers>
                <TapGestureRecognizer Tapped="OnFrameTapped"/>
            </Frame.GestureRecognizers>

            <VerticalStackLayout
            VerticalOptions="Center" 
            HorizontalOptions="Center">
                <Label
                    Text='Take photo'
                    Scale='1'/>
            </VerticalStackLayout>
        </Frame>
        
        <Button Text="Take Image" Clicked="OnTakeImageClicked" Style="{StaticResource ImageOptionStyle}"/>
        <Button Text="Select Image"
                Clicked="OnSelectImageClicked"
                Style="{StaticResource ImageOptionStyle}"
                Command="{Binding SelectImageCommand}"/>

        <Image x:Name="capturedImage" VerticalOptions="CenterAndExpand" HorizontalOptions="CenterAndExpand" />

    </VerticalStackLayout>-->
</ContentPage>